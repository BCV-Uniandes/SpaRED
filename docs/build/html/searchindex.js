Search.setIndex({"alltitles": {"API": [[0, "api"]], "Contents": [[41, "contents"]], "Dataloaders": [[0, "module-spared.dataloaders"]], "Datasets": [[0, "module-spared.datasets"]], "Denoising": [[0, "module-spared.denoising"]], "Filtering": [[0, "module-spared.filtering"]], "Gene Features": [[0, "module-spared.gene_features"]], "Graph Operations": [[0, "module-spared.graph_operations"]], "Indices and tables": [[41, "indices-and-tables"]], "Installation": [[42, "installation"]], "Layer Operations": [[0, "module-spared.layer_operations"]], "Metrics": [[0, "module-spared.metrics"]], "Models": [[0, "module-spared.models"]], "Plotting": [[0, "module-spared.plotting"]], "PyPI": [[42, "pypi"]], "Spot Features": [[0, "module-spared.spot_features"]], "Welcome to SpaRED\u2019s documentation!": [[41, "welcome-to-spared-s-documentation"]], "spared.dataloaders.get_graph_dataloaders": [[1, "spared-dataloaders-get-graph-dataloaders"]], "spared.dataloaders.get_pretrain_dataloaders": [[2, "spared-dataloaders-get-pretrain-dataloaders"]], "spared.datasets.get_dataset": [[3, "spared-datasets-get-dataset"]], "spared.denoising.median_cleaner": [[4, "spared-denoising-median-cleaner"]], "spared.denoising.spackle_cleaner": [[5, "spared-denoising-spackle-cleaner"]], "spared.filtering.filter_by_moran": [[6, "spared-filtering-filter-by-moran"]], "spared.filtering.filter_dataset": [[7, "spared-filtering-filter-dataset"]], "spared.filtering.get_slide_from_collection": [[8, "spared-filtering-get-slide-from-collection"]], "spared.filtering.get_slides_adata": [[9, "spared-filtering-get-slides-adata"]], "spared.gene_features.compute_moran": [[10, "spared-gene-features-compute-moran"]], "spared.gene_features.get_exp_frac": [[11, "spared-gene-features-get-exp-frac"]], "spared.gene_features.get_glob_exp_frac": [[12, "spared-gene-features-get-glob-exp-frac"]], "spared.graph_operations.get_graphs": [[13, "spared-graph-operations-get-graphs"]], "spared.graph_operations.get_graphs_one_slide": [[14, "spared-graph-operations-get-graphs-one-slide"]], "spared.graph_operations.get_sin_cos_positional_embeddings": [[15, "spared-graph-operations-get-sin-cos-positional-embeddings"]], "spared.layer_operations.add_noisy_layer": [[16, "spared-layer-operations-add-noisy-layer"]], "spared.layer_operations.combat_transformation": [[17, "spared-layer-operations-combat-transformation"]], "spared.layer_operations.get_deltas": [[18, "spared-layer-operations-get-deltas"]], "spared.layer_operations.log1p_transformation": [[19, "spared-layer-operations-log1p-transformation"]], "spared.layer_operations.process_dataset": [[20, "spared-layer-operations-process-dataset"]], "spared.layer_operations.tpm_normalization": [[21, "spared-layer-operations-tpm-normalization"]], "spared.metrics.get_metrics": [[22, "spared-metrics-get-metrics"]], "spared.metrics.get_pearsonr": [[23, "spared-metrics-get-pearsonr"]], "spared.metrics.get_r2_score": [[24, "spared-metrics-get-r2-score"]], "spared.models.ImageEncoder": [[25, "spared-models-imageencoder"]], "spared.plotting.plot_all_slides": [[26, "spared-plotting-plot-all-slides"]], "spared.plotting.plot_clusters": [[27, "spared-plotting-plot-clusters"]], "spared.plotting.plot_data_distribution_stats": [[28, "spared-plotting-plot-data-distribution-stats"]], "spared.plotting.plot_exp_frac": [[29, "spared-plotting-plot-exp-frac"]], "spared.plotting.plot_histograms": [[30, "spared-plotting-plot-histograms"]], "spared.plotting.plot_mean_std": [[31, "spared-plotting-plot-mean-std"]], "spared.plotting.plot_mean_std_partitions": [[32, "spared-plotting-plot-mean-std-partitions"]], "spared.plotting.plot_random_patches": [[33, "spared-plotting-plot-random-patches"]], "spared.plotting.plot_tests": [[34, "spared-plotting-plot-tests"]], "spared.plotting.visualize_gene_expression": [[35, "spared-plotting-visualize-gene-expression"]], "spared.plotting.visualize_moran_filtering": [[36, "spared-plotting-visualize-moran-filtering"]], "spared.spot_features.compute_dim_red": [[37, "spared-spot-features-compute-dim-red"]], "spared.spot_features.compute_patches_embeddings": [[38, "spared-spot-features-compute-patches-embeddings"]], "spared.spot_features.compute_patches_predictions": [[39, "spared-spot-features-compute-patches-predictions"]], "spared.spot_features.get_spatial_neighbors": [[40, "spared-spot-features-get-spatial-neighbors"]]}, "docnames": ["api", "api/spared.dataloaders.get_graph_dataloaders", "api/spared.dataloaders.get_pretrain_dataloaders", "api/spared.datasets.get_dataset", "api/spared.denoising.median_cleaner", "api/spared.denoising.spackle_cleaner", "api/spared.filtering.filter_by_moran", "api/spared.filtering.filter_dataset", "api/spared.filtering.get_slide_from_collection", "api/spared.filtering.get_slides_adata", "api/spared.gene_features.compute_moran", "api/spared.gene_features.get_exp_frac", "api/spared.gene_features.get_glob_exp_frac", "api/spared.graph_operations.get_graphs", "api/spared.graph_operations.get_graphs_one_slide", "api/spared.graph_operations.get_sin_cos_positional_embeddings", "api/spared.layer_operations.add_noisy_layer", "api/spared.layer_operations.combat_transformation", "api/spared.layer_operations.get_deltas", "api/spared.layer_operations.log1p_transformation", "api/spared.layer_operations.process_dataset", "api/spared.layer_operations.tpm_normalization", "api/spared.metrics.get_metrics", "api/spared.metrics.get_pearsonr", "api/spared.metrics.get_r2_score", "api/spared.models.ImageEncoder", "api/spared.plotting.plot_all_slides", "api/spared.plotting.plot_clusters", "api/spared.plotting.plot_data_distribution_stats", "api/spared.plotting.plot_exp_frac", "api/spared.plotting.plot_histograms", "api/spared.plotting.plot_mean_std", "api/spared.plotting.plot_mean_std_partitions", "api/spared.plotting.plot_random_patches", "api/spared.plotting.plot_tests", "api/spared.plotting.visualize_gene_expression", "api/spared.plotting.visualize_moran_filtering", "api/spared.spot_features.compute_dim_red", "api/spared.spot_features.compute_patches_embeddings", "api/spared.spot_features.compute_patches_predictions", "api/spared.spot_features.get_spatial_neighbors", "index", "installation"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["api.rst", "api/spared.dataloaders.get_graph_dataloaders.rst", "api/spared.dataloaders.get_pretrain_dataloaders.rst", "api/spared.datasets.get_dataset.rst", "api/spared.denoising.median_cleaner.rst", "api/spared.denoising.spackle_cleaner.rst", "api/spared.filtering.filter_by_moran.rst", "api/spared.filtering.filter_dataset.rst", "api/spared.filtering.get_slide_from_collection.rst", "api/spared.filtering.get_slides_adata.rst", "api/spared.gene_features.compute_moran.rst", "api/spared.gene_features.get_exp_frac.rst", "api/spared.gene_features.get_glob_exp_frac.rst", "api/spared.graph_operations.get_graphs.rst", "api/spared.graph_operations.get_graphs_one_slide.rst", "api/spared.graph_operations.get_sin_cos_positional_embeddings.rst", "api/spared.layer_operations.add_noisy_layer.rst", "api/spared.layer_operations.combat_transformation.rst", "api/spared.layer_operations.get_deltas.rst", "api/spared.layer_operations.log1p_transformation.rst", "api/spared.layer_operations.process_dataset.rst", "api/spared.layer_operations.tpm_normalization.rst", "api/spared.metrics.get_metrics.rst", "api/spared.metrics.get_pearsonr.rst", "api/spared.metrics.get_r2_score.rst", "api/spared.models.ImageEncoder.rst", "api/spared.plotting.plot_all_slides.rst", "api/spared.plotting.plot_clusters.rst", "api/spared.plotting.plot_data_distribution_stats.rst", "api/spared.plotting.plot_exp_frac.rst", "api/spared.plotting.plot_histograms.rst", "api/spared.plotting.plot_mean_std.rst", "api/spared.plotting.plot_mean_std_partitions.rst", "api/spared.plotting.plot_random_patches.rst", "api/spared.plotting.plot_tests.rst", "api/spared.plotting.visualize_gene_expression.rst", "api/spared.plotting.visualize_moran_filtering.rst", "api/spared.spot_features.compute_dim_red.rst", "api/spared.spot_features.compute_patches_embeddings.rst", "api/spared.spot_features.compute_patches_predictions.rst", "api/spared.spot_features.get_spatial_neighbors.rst", "index.rst", "installation.rst"], "indexentries": {"add_noisy_layer() (in module spared.layer_operations)": [[16, "spared.layer_operations.add_noisy_layer", false]], "combat_transformation() (in module spared.layer_operations)": [[17, "spared.layer_operations.combat_transformation", false]], "get_deltas() (in module spared.layer_operations)": [[18, "spared.layer_operations.get_deltas", false]], "log1p_transformation() (in module spared.layer_operations)": [[19, "spared.layer_operations.log1p_transformation", false]], "module": [[0, "module-spared.dataloaders", false], [0, "module-spared.datasets", false], [0, "module-spared.denoising", false], [0, "module-spared.filtering", false], [0, "module-spared.gene_features", false], [0, "module-spared.graph_operations", false], [0, "module-spared.layer_operations", false], [0, "module-spared.metrics", false], [0, "module-spared.models", false], [0, "module-spared.plotting", false], [0, "module-spared.spot_features", false]], "process_dataset() (in module spared.layer_operations)": [[20, "spared.layer_operations.process_dataset", false]], "spared.dataloaders": [[0, "module-spared.dataloaders", false]], "spared.datasets": [[0, "module-spared.datasets", false]], "spared.denoising": [[0, "module-spared.denoising", false]], "spared.filtering": [[0, "module-spared.filtering", false]], "spared.gene_features": [[0, "module-spared.gene_features", false]], "spared.graph_operations": [[0, "module-spared.graph_operations", false]], "spared.layer_operations": [[0, "module-spared.layer_operations", false]], "spared.metrics": [[0, "module-spared.metrics", false]], "spared.models": [[0, "module-spared.models", false]], "spared.plotting": [[0, "module-spared.plotting", false]], "spared.spot_features": [[0, "module-spared.spot_features", false]], "tpm_normalization() (in module spared.layer_operations)": [[21, "spared.layer_operations.tpm_normalization", false]]}, "objects": {"spared": [[0, 0, 0, "-", "dataloaders"], [0, 0, 0, "-", "datasets"], [0, 0, 0, "-", "denoising"], [0, 0, 0, "-", "filtering"], [0, 0, 0, "-", "gene_features"], [0, 0, 0, "-", "graph_operations"], [0, 0, 0, "-", "layer_operations"], [0, 0, 0, "-", "metrics"], [0, 0, 0, "-", "models"], [0, 0, 0, "-", "plotting"], [0, 0, 0, "-", "spot_features"]], "spared.dataloaders": [[1, 1, 1, "", "get_graph_dataloaders"], [2, 1, 1, "", "get_pretrain_dataloaders"]], "spared.datasets": [[3, 1, 1, "", "get_dataset"]], "spared.denoising": [[4, 1, 1, "", "median_cleaner"], [5, 1, 1, "", "spackle_cleaner"]], "spared.filtering": [[6, 1, 1, "", "filter_by_moran"], [7, 1, 1, "", "filter_dataset"], [8, 1, 1, "", "get_slide_from_collection"], [9, 1, 1, "", "get_slides_adata"]], "spared.gene_features": [[10, 1, 1, "", "compute_moran"], [11, 1, 1, "", "get_exp_frac"], [12, 1, 1, "", "get_glob_exp_frac"]], "spared.graph_operations": [[13, 1, 1, "", "get_graphs"], [14, 1, 1, "", "get_graphs_one_slide"], [15, 1, 1, "", "get_sin_cos_positional_embeddings"]], "spared.layer_operations": [[16, 1, 1, "", "add_noisy_layer"], [17, 1, 1, "", "combat_transformation"], [18, 1, 1, "", "get_deltas"], [19, 1, 1, "", "log1p_transformation"], [20, 1, 1, "", "process_dataset"], [21, 1, 1, "", "tpm_normalization"]], "spared.metrics": [[22, 1, 1, "", "get_metrics"], [23, 1, 1, "", "get_pearsonr"], [24, 1, 1, "", "get_r2_score"]], "spared.models": [[25, 2, 1, "", "ImageEncoder"]], "spared.models.ImageEncoder": [[25, 3, 1, "", "__init__"]], "spared.plotting": [[26, 1, 1, "", "plot_all_slides"], [27, 1, 1, "", "plot_clusters"], [28, 1, 1, "", "plot_data_distribution_stats"], [29, 1, 1, "", "plot_exp_frac"], [30, 1, 1, "", "plot_histograms"], [31, 1, 1, "", "plot_mean_std"], [32, 1, 1, "", "plot_mean_std_partitions"], [33, 1, 1, "", "plot_random_patches"], [34, 1, 1, "", "plot_tests"], [35, 1, 1, "", "visualize_gene_expression"], [36, 1, 1, "", "visualize_moran_filtering"]], "spared.spot_features": [[37, 1, 1, "", "compute_dim_red"], [38, 1, 1, "", "compute_patches_embeddings"], [39, 1, 1, "", "compute_patches_predictions"], [40, 1, 1, "", "get_spatial_neighbors"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "terms": {"": [6, 7, 10, 19, 20, 28], "0": [5, 6, 7, 11, 12, 20, 23, 24, 38, 39], "001": 5, "1": [11, 12, 16, 17, 19, 20, 23, 24], "1000": 5, "10xgenomic_human_brain": 3, "10xgenomic_human_breast_canc": 3, "10xgenomic_mouse_brain_coron": 3, "10xgenomic_mouse_brain_sagittal_anterior": 3, "10xgenomic_mouse_brain_sagittal_posterior": 3, "128": [1, 2, 6], "16": 33, "2": [1, 19, 22, 23, 24, 35], "224": [1, 33, 38, 39], "255": [38, 39], "3": [38, 39], "32": 6, "320": 6, "4": [35, 36], "6": 34, "A": [7, 11, 12, 13, 14, 15, 20, 34, 38, 39], "For": 13, "If": [1, 2, 4, 6, 7, 20, 22, 35, 36, 38, 39, 40], "In": [1, 16], "It": [1, 6, 11, 12, 14, 15, 20, 21, 23, 24, 27, 31, 33, 38, 39], "Its": 12, "The": [1, 2, 3, 4, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 27, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "Then": 22, "To": [11, 21, 23, 24], "Will": [13, 14], "__init__": 25, "_avg_exp": 18, "_description_": 1, "_moran": [6, 10], "abalo_human_squamous_cell_carcinoma": 3, "ablat": 16, "absolut": [15, 22], "accord": [7, 40], "account": [4, 40], "across": [7, 10, 11, 20], "activ": 41, "ad": [1, 2, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38, 39, 40], "ada": [], "adam": 5, "adapt": [4, 20], "adaptive_median_filter_pepp": 4, "adata": [1, 2, 4, 5, 6, 7, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 27, 32, 33, 34, 35, 36, 37, 38, 39, 40], "add": [15, 16, 18, 20], "adit": 22, "after": [3, 7, 10, 13, 20], "aggreg": 11, "all": [1, 7, 8, 9, 10, 11, 12, 13, 16, 18, 20, 22, 23, 24, 26, 31, 32, 34, 38, 39], "alreadi": [1, 6, 16, 20, 38, 39], "also": [1, 18, 21, 22, 34, 39], "alwai": 39, "an": [2, 4, 7, 8, 11, 14, 16, 21, 29, 38, 39, 40], "analog": 4, "analys": 30, "analysi": 7, "analyz": 41, "ani": [7, 11, 12], "anndata": [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "annload": 2, "annot": 21, "appli": 21, "approxim": 17, "ar": [1, 2, 7, 13, 14, 15, 16, 17, 18, 20, 21, 22, 30, 34, 36, 38, 39, 40], "argument": 7, "around": 37, "arrai": 22, "artifici": 16, "aspect": 26, "assign": 16, "atabas": 41, "attribut": [14, 15, 25], "auto": 36, "autocorrel": 30, "automat": 6, "averag": [10, 18, 20, 22, 23, 24], "axi": [23, 24], "backbon": [1, 25, 38, 39], "bar": 28, "base": [2, 7, 8, 19], "batch": [1, 2, 17, 20, 27], "batch_kei": 17, "batch_siz": [1, 2], "been": 39, "befor": 10, "between": [11, 12, 14, 23, 24], "bidimension": 33, "binari": [16, 20], "black": 31, "blue": 30, "bool": [1, 2, 3, 4, 10, 13, 14, 20, 22, 36, 40], "boolean": [22, 23, 24], "both": [7, 14, 25, 41], "bound": 11, "build": [13, 41], "c_d_delta": 20, "c_d_log1p": [2, 20], "c_delta": 20, "c_log1p": 20, "c_t_log1p": 1, "calculate_qc_metr": 7, "call": [3, 34], "can": [3, 4, 17, 21, 27, 38, 39, 40], "case": [1, 16], "cell": 30, "cell_max_count": 7, "cell_min_count": 7, "center": 14, "chart": 28, "check": [1, 34], "choos": 35, "chosen": [27, 36], "cialli": 41, "class": [24, 25, 34], "clean": 4, "cluster": [27, 37], "code": 4, "collect": [4, 7, 8, 9, 10, 11, 12, 26, 29, 35, 40, 41], "color": [27, 32], "column": [6, 8, 9, 11, 12, 14, 17, 18, 20, 23, 24], "combat": [17, 20], "combat_kei": 20, "comma": 9, "command": 3, "complet": [7, 11, 20, 27, 29], "comput": [1, 4, 6, 7, 10, 11, 12, 13, 14, 17, 18, 20, 22, 23, 24, 37, 38, 39, 40], "concaten": [8, 9, 13, 22], "concentr": 4, "configur": 3, "connect": 40, "constant": 30, "contain": [7, 20, 22, 27, 35, 36], "control": [7, 34], "convnext": [38, 39], "copi": [8, 9], "correct": [17, 20, 27], "correctli": 34, "correl": [22, 23, 36], "correspond": [3, 30], "corrupt": 16, "count": [7, 20, 21, 29, 30], "creat": [16, 34], "cuda": 2, "cycl": 10, "d": 41, "d_delta": 20, "d_log1p": 20, "d_log1p_moran": 20, "data": [1, 2, 3, 4, 10, 14, 16, 17, 18, 19, 20, 21, 26, 27, 28, 30, 31, 32, 33, 35, 36, 37], "datafram": [8, 9], "dataset": [1, 2, 5, 10, 11, 12, 13, 20, 21, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 39, 40, 41], "dataset_log": 34, "dataset_nam": 3, "dataset_path": 1, "date": 34, "declar": 39, "default": [1, 2, 3, 13, 33, 36, 37, 38, 39], "defin": [11, 12, 17, 20, 40], "delta": [2, 16, 18, 20], "denois": [16, 20], "densenet": [1, 38, 39], "depend": [7, 16], "detail": [4, 7, 13, 22], "detailed_error": 22, "detailed_error_gen": 22, "detailed_mae_gen": 22, "detailed_mse_gen": 22, "detalied_pcc": 23, "detalied_r2_scor": 24, "determin": 18, "develop": 41, "deviat": [18, 31, 32], "devic": 5, "dict": [7, 13, 14, 15, 20, 22, 27, 29, 34, 35, 36, 40], "dictionari": [1, 7, 13, 14, 15, 20, 22, 27, 34, 35, 36, 40], "differ": [12, 14, 32], "dim": 33, "dimension": 37, "distanc": 40, "distribut": [17, 27, 28], "do": [23, 24], "doe": 1, "doesn": 20, "don": 7, "done": [32, 38, 39], "draw": 32, "e": [9, 41], "each": [3, 4, 7, 9, 10, 11, 12, 13, 14, 15, 18, 20, 23, 24, 27, 36, 40], "effect": [30, 31], "efficientnetv2": [38, 39], "either": 35, "element": 40, "els": 6, "embed": [1, 13, 14, 27, 37, 38], "embeddings_": 38, "encod": [2, 7, 14, 15], "ensur": 11, "erickson_human_prostate_cancer_p1": 3, "erickson_human_prostate_cancer_p2": 3, "error": 22, "esolv": 41, "everi": [14, 22], "everyth": 37, "exclud": 30, "exp_frac": [7, 11], "expect": 20, "experiment": 16, "express": [2, 7, 10, 11, 12, 18, 20, 21, 27, 29, 30, 32, 35, 36, 37, 39], "f": [6, 10, 18, 38, 39], "fals": [2, 4, 16, 20, 22, 23, 24, 36, 40], "fan_mouse_brain_coron": 3, "fan_mouse_olfatory_bulb": 3, "faster": 3, "figur": 30, "file": [3, 7, 21, 30, 31], "filter": [4, 20, 26, 27, 28, 30, 31, 32, 33, 35, 36], "filter_dataset": 20, "final": [11, 20, 23, 24, 34], "first": [3, 14, 30, 40], "flat": [22, 33], "flatten": [38, 39], "float": [7, 23, 24], "folder": [1, 34], "folder_path": 34, "follow": [1, 3, 6, 7, 20, 22, 38, 39], "form": 33, "format": [14, 34, 36, 38, 39], "found": [4, 40], "fount": 21, "fraction": [7, 11, 12, 29], "from": [3, 4, 6, 8, 9, 17, 18, 19, 20, 21, 30, 31, 33, 35, 38, 39, 40], "from_lay": [4, 5, 6, 10, 17, 18, 19, 21, 27, 32, 35, 36, 37], "function": [1, 2, 3, 4, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 38, 39, 40], "g": 9, "gene": [2, 6, 7, 10, 11, 12, 16, 18, 20, 21, 22, 30, 31, 32, 34, 35, 36, 39], "gene_max_count": 7, "gene_min_count": 7, "gener": [22, 27, 28, 30, 36], "genom": 21, "geo_dataload": 1, "geometr": [13, 14, 15], "geometri": [4, 10, 14], "get": [1, 2, 3, 8, 9, 11, 13, 14, 15, 18, 20, 22, 33], "get_exp_frac": 7, "get_glob_exp_frac": 7, "get_graphs_one_slid": 13, "get_performance_metr": 5, "get_sin_cos_positional_embed": 13, "given": [36, 38, 39], "glob_exp_frac": [7, 12], "global": [12, 22, 29], "graph": [1, 4, 13, 14, 15, 20, 40], "graph_dict": 15, "green": 30, "grid": [4, 20, 40], "ground": [22, 23, 24], "gt_mat": [22, 23, 24], "gtf": 21, "h5ad": [30, 31], "ha": [1, 4, 14, 16, 30, 31, 39], "have": [6, 10, 11, 12, 14, 16, 17, 18, 37, 39], "heatmap": 29, "henc": 11, "here": 7, "hex_geometri": [1, 4, 10, 13, 14, 20, 40], "hexagon": [1, 4, 10, 13, 14, 20, 40], "highest": [6, 20], "histogram": 30, "hop": [1, 13, 14], "host": 41, "how": 32, "howev": [18, 20], "human": 21, "i": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 20, 23, 24, 27, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41], "identifi": 17, "ignor": [22, 23, 24], "imag": [2, 26, 27, 28, 31, 32, 33, 35, 36], "imagenet": [38, 39], "import": 0, "importantli": [17, 40], "imput": [16, 20], "inceptionv3": [38, 39], "includ": [20, 22, 40], "increas": 3, "index": [34, 40, 41], "individu": 22, "inform": [11, 12, 15, 18, 30, 31, 38, 39], "initi": 25, "input": [10, 15, 17, 20], "insid": [4, 38, 39, 40], "instead": [1, 7], "int": [1, 2, 4, 6, 7, 13, 14, 15, 20, 23, 24, 33, 34, 38, 39, 40], "intern": [10, 20, 25], "ir": [23, 24], "its": 16, "itself": 40, "json": 34, "keep": [6, 7, 20], "kei": [7, 10, 13, 14, 15, 20, 22, 27, 32, 35, 37, 38, 39, 40], "last": 38, "latent_dim": 25, "layer": [1, 2, 4, 6, 10, 13, 14, 16, 17, 18, 19, 20, 21, 27, 31, 32, 35, 36, 37, 38], "least": [7, 11, 36], "leav": 7, "leiden": [27, 37], "less": 6, "librari": 41, "like": 15, "list": [7, 9, 20, 23, 24, 36, 40], "load": [1, 3, 30, 31], "load_ckpt_path": 5, "loader": 2, "log": 34, "log1p": [19, 20], "log_2": [16, 17, 19, 20], "logarithm": [16, 17, 19, 20], "long": [38, 39], "low": 7, "lower": 11, "lr": 5, "mae": 22, "mask": [16, 20, 22, 23, 24], "matric": [22, 23, 24], "matrix": [7, 11, 12, 15, 22, 23, 24, 27, 32, 35, 37], "matter": 7, "max": [14, 15], "max_d_po": 15, "max_step": 5, "maximum": [4, 7], "maxvit": [38, 39], "mean": [2, 6, 7, 11, 12, 16, 18, 20, 22, 23, 24, 31, 32], "mean_pcc": 23, "mean_r2_scor": 24, "median": [4, 20], "method": [25, 35], "metric": [7, 20], "min_exp_frac": 7, "min_glob_exp_frac": 7, "minimum": [7, 11], "mirzazadeh_human_colon_p1": 3, "mirzazadeh_human_colon_p2": 3, "mirzazadeh_human_pediatric_brain_tumor_p1": 3, "mirzazadeh_human_pediatric_brain_tumor_p2": 3, "mirzazadeh_human_prostate_canc": 3, "mirzazadeh_human_small_intestin": 3, "mirzazadeh_mouse_bon": 3, "mirzazadeh_mouse_brain": 3, "mirzazadeh_mouse_brain_p1": 3, "mirzazadeh_mouse_brain_p2": 3, "miss": [4, 16, 20], "mobilenetv3": [38, 39], "model": [1, 2, 26, 27, 28, 30, 31, 32, 33, 36, 38, 39], "model_path": [1, 38, 39], "modifi": [4, 38, 39], "modul": [25, 41], "moran": [6, 10, 20, 30, 36], "morani": [], "more": 7, "most": 36, "mous": 21, "mse": 22, "much": 3, "must": [6, 7, 8, 9, 10, 14, 16, 17, 18, 20, 21, 22, 23, 24, 37, 38, 39], "n_gene": 22, "n_hop": [1, 4, 13, 14, 40], "n_keep": 6, "n_observ": [23, 24], "n_patch": [38, 39], "n_sampl": 22, "n_var": [6, 39], "n_variabl": [23, 24], "name": [3, 8, 13, 14, 15, 26, 27, 28, 31, 32, 33, 34, 35, 36], "need": [38, 39], "neg": 16, "neighbor": [4, 10, 14, 15, 37, 40], "neighborhood": 40, "new": [4, 41], "next": 3, "nn": 25, "node": 14, "nois": 4, "noisi": 16, "noisy_d": 16, "non": [11, 12, 31], "none": [1, 2, 7, 20, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 38, 39], "normal": [17, 20, 21, 38, 39], "note": [14, 17, 39], "np": 22, "number": [1, 4, 6, 11, 12, 13, 14, 20, 39], "numpi": 22, "ob": [8, 9, 17, 18, 20], "object": [1, 2, 3, 6, 8, 9, 10, 13, 14, 16, 17, 18, 19, 20, 21, 33, 36, 37, 38, 39, 40], "observ": [7, 18, 20, 36, 40], "obsm": [14, 38, 39], "one": [3, 11, 14, 15, 23, 24, 38, 39], "ones": 41, "onli": [2, 7, 10, 13, 16, 18, 20, 30, 38, 39, 40], "optim": 5, "option": [1, 2, 3, 7, 36, 38, 39], "organ": 21, "origin": [8, 9, 17], "other": 7, "out": 7, "output": [17, 39], "outsid": 7, "over": [10, 17, 19, 20, 30, 40], "packag": 17, "page": 41, "paper": 17, "param_dict": [7, 20, 27, 29, 34, 35, 36], "paramet": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "parigi_mouse_intestin": 3, "patch": [1, 2, 14, 15, 22, 23, 30, 31, 33, 38, 39], "patch_scal": [38, 39], "patch_siz": [1, 33, 34, 38, 39], "patches_scal": [38, 39], "patches_scale_": [38, 39], "patches_scale_1": [38, 39], "path": [1, 7, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 38, 39], "patient": 35, "pca": [27, 37], "pcc": [22, 23, 24], "pearson": [22, 23], "per": 30, "perform": [1, 7, 17, 19, 20, 21, 34], "pie": 28, "pip": 42, "pipelin": [1, 7, 20], "place": [38, 39], "pleas": 39, "plot": [], "plotting_gen": 35, "plotting_slid": [27, 35, 36], "posit": [13, 14, 15, 22, 23, 24], "positional_embed": 15, "pp": [7, 19, 37], "ppc": 22, "pre": 2, "pred_mat": [22, 23, 24], "predefin": 3, "predict": [1, 2, 6, 13, 14, 20, 22, 23, 24, 39], "prediction_lay": 16, "predictions_": 39, "present": [6, 7, 16, 20, 31, 32], "pretrain": [2, 38, 39], "proce": 6, "process": [1, 2, 4, 7, 20, 26, 27, 28, 30, 31, 32, 33, 34, 35, 36, 38, 39, 40], "processed_adata": [26, 27, 28, 30, 31, 32, 33, 34, 35, 36], "project": 41, "proport": [11, 12], "provid": 36, "pure": 2, "purpos": 16, "pycombat": 17, "python": 41, "pytorch": [13, 14, 15, 38, 39], "qualiti": [7, 34], "r": 41, "r2": [22, 24], "radiu": 14, "rais": [38, 39], "random": [33, 36, 39], "randomli": [27, 35], "rang": 7, "ratio": 26, "raw": [7, 20, 21, 29, 30], "raw_adata": [29, 30, 31, 34], "read": 7, "readi": [26, 27, 28, 30, 31, 32, 33, 36], "real": 16, "receiv": [3, 8, 9, 14, 22, 23, 24], "recommend": [17, 20], "recomput": 1, "red": 30, "reduct": 37, "refer": 21, "regress": 22, "rel": 15, "remov": [4, 7, 21], "represent": 38, "reproduc": 34, "reshap": 33, "resnet": [38, 39], "resnet50": [38, 39], "resnetxt": [38, 39], "result": [4, 17, 18, 19, 20, 21, 34], "retriev": [3, 8], "return": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 37, 40], "ring": 4, "row": [14, 23, 24, 30], "run": [3, 42], "same": [34, 39], "sampl": [7, 20], "save": [1, 10, 18, 19, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36], "sc": [7, 19, 37], "scale": 16, "scanpi": [7, 19], "scatter": [31, 32], "score": [22, 24], "scriptmodul": 25, "search": 41, "second": 30, "see": [7, 13, 31, 32], "select": [6, 35], "separ": 9, "set": [1, 2, 20, 33, 38, 39, 41], "shape": [22, 23, 24, 38, 39], "share": 25, "should": [3, 16, 17, 20, 21, 38, 39], "show": [33, 36], "shuffl": [1, 2], "shufflenetv2": [38, 39], "significantli": 3, "similar": 7, "simpl": [19, 37], "singl": [13, 14, 40], "size": [1, 2, 4, 33, 38, 39, 40], "slide": [4, 7, 8, 9, 10, 11, 12, 13, 14, 20, 26, 27, 28, 29, 35, 36, 40], "slide1": 9, "slide2": 9, "slide3": 9, "slide_id": [8, 9], "slide_list": 9, "so": [17, 39], "sourc": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "spa": 41, "spare": [0, 42], "spatial": [4, 10, 27, 36, 39, 41], "spatialdataset": 3, "specif": [35, 36], "specifi": [1, 3, 6, 7, 8, 9, 16, 20, 21, 27, 30, 31, 32, 33, 35, 36, 38, 39], "specifii": [], "split": [18, 27, 28, 32, 35, 36], "split_nam": [27, 34, 35, 36], "spot": [7, 11, 12, 13, 20, 28], "squar": [22, 26], "standard": [31, 32], "stat": 28, "state": 25, "statist": [6, 10, 30, 36], "std": [31, 32], "step": [1, 7, 34], "stnet_dataset": 35, "store": [1, 3, 4, 17, 18, 19, 21, 27, 32, 37, 38, 39], "str": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18, 19, 20, 21, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39], "string": [9, 36, 38, 39], "subplot": 36, "suitabl": 7, "summari": 7, "support": [38, 39], "swin": [38, 39], "t": [7, 20], "take": [4, 7, 11, 17, 18, 19, 21, 23, 24, 26, 40], "taken": [4, 9, 21], "task": 32, "technologi": 4, "tensor": [22, 23, 24], "test": [1, 2, 32], "th": [23, 24], "than": 6, "thei": 1, "them": [1, 7, 13, 18, 22, 23, 24, 33, 35, 41], "therefor": 17, "thi": [1, 2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41], "time": [3, 34], "titl": 36, "tl": 37, "to_lay": [4, 5, 17, 18, 19, 21], "tool": 41, "top": [20, 36], "top_moran_gen": 20, "topolog": 40, "torch": [22, 23, 24], "total": [7, 30], "total_count": 7, "tpm": [16, 17, 20, 21], "tractabl": 32, "train": [1, 2, 5, 18, 32], "transcriptom": [39, 41], "transform": [15, 17, 18, 19, 20, 37, 38, 39], "true": [1, 2, 3, 4, 5, 10, 13, 16, 20, 22, 36, 40], "truth": [22, 23, 24], "try": 39, "tupl": [1, 2, 14, 23, 24], "txt": [7, 34], "type": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 37, 40], "umap": [27, 37], "under": [15, 41], "unexpress": 7, "unfilt": [7, 29], "union": 22, "unprocess": [7, 29], "updat": [6, 10, 11, 12, 16, 17, 18, 19, 21], "us": [1, 2, 7, 10, 13, 14, 16, 17, 18, 20, 21, 26, 27, 28, 30, 31, 32, 33, 34, 36, 37, 38, 39], "use_cuda": 2, "use_pretrain": 25, "user": 17, "val": 32, "valid": [1, 2, 7, 20, 22], "valu": [6, 7, 10, 11, 12, 13, 14, 15, 16, 18, 20, 21, 36, 37, 40], "valueerror": [38, 39], "var": [6, 10, 11, 12, 18, 20], "variabl": [17, 20], "vicari_human_striatium": 3, "vicari_mouse_brain": 3, "vicin": 40, "view": [8, 9], "villacampa_kidney_organoid": 3, "villacampa_lung_organoid": 3, "villacampa_mouse_brain": 3, "vision": 2, "visium": [4, 10, 13, 20, 35, 40], "visual": [3, 27, 36], "vit": [38, 39], "wa": [6, 20], "wai": 6, "want": [38, 39], "we": [6, 7], "wether": [23, 24], "whatev": [38, 39], "where": [1, 4, 11, 12, 13, 14, 15, 27, 32, 37, 40], "whether": [1, 2, 3, 10, 13, 14, 20, 40], "which": [6, 13, 17, 20, 21, 30], "whole": [7, 12, 26], "wideresnet": [38, 39], "wildcard_gen": 7, "window": 4, "wise": 22, "word": [38, 39], "wrap": 13, "wrapper": [19, 37], "x": [2, 7, 11, 12, 19, 20], "xpression": 41, "y": [13, 14], "you": [38, 39], "zero": [7, 16, 31]}, "titles": ["API", "spared.dataloaders.get_graph_dataloaders", "spared.dataloaders.get_pretrain_dataloaders", "spared.datasets.get_dataset", "spared.denoising.median_cleaner", "spared.denoising.spackle_cleaner", "spared.filtering.filter_by_moran", "spared.filtering.filter_dataset", "spared.filtering.get_slide_from_collection", "spared.filtering.get_slides_adata", "spared.gene_features.compute_moran", "spared.gene_features.get_exp_frac", "spared.gene_features.get_glob_exp_frac", "spared.graph_operations.get_graphs", "spared.graph_operations.get_graphs_one_slide", "spared.graph_operations.get_sin_cos_positional_embeddings", "spared.layer_operations.add_noisy_layer", "spared.layer_operations.combat_transformation", "spared.layer_operations.get_deltas", "spared.layer_operations.log1p_transformation", "spared.layer_operations.process_dataset", "spared.layer_operations.tpm_normalization", "spared.metrics.get_metrics", "spared.metrics.get_pearsonr", "spared.metrics.get_r2_score", "spared.models.ImageEncoder", "spared.plotting.plot_all_slides", "spared.plotting.plot_clusters", "spared.plotting.plot_data_distribution_stats", "spared.plotting.plot_exp_frac", "spared.plotting.plot_histograms", "spared.plotting.plot_mean_std", "spared.plotting.plot_mean_std_partitions", "spared.plotting.plot_random_patches", "spared.plotting.plot_tests", "spared.plotting.visualize_gene_expression", "spared.plotting.visualize_moran_filtering", "spared.spot_features.compute_dim_red", "spared.spot_features.compute_patches_embeddings", "spared.spot_features.compute_patches_predictions", "spared.spot_features.get_spatial_neighbors", "Welcome to SpaRED\u2019s documentation!", "Installation"], "titleterms": {"": 41, "add_noisy_lay": 16, "api": 0, "combat_transform": 17, "compute_dim_r": 37, "compute_moran": 10, "compute_patches_embed": 38, "compute_patches_predict": 39, "content": 41, "dataload": [0, 1, 2], "dataset": [0, 3], "denois": [0, 4, 5], "document": 41, "featur": 0, "filter": [0, 6, 7, 8, 9], "filter_by_moran": 6, "filter_dataset": 7, "gene": 0, "gene_featur": [10, 11, 12], "get_dataset": 3, "get_delta": 18, "get_exp_frac": 11, "get_glob_exp_frac": 12, "get_graph": 13, "get_graph_dataload": 1, "get_graphs_one_slid": 14, "get_metr": 22, "get_pearsonr": 23, "get_pretrain_dataload": 2, "get_r2_scor": 24, "get_sin_cos_positional_embed": 15, "get_slide_from_collect": 8, "get_slides_adata": 9, "get_spatial_neighbor": 40, "graph": 0, "graph_oper": [13, 14, 15], "imageencod": 25, "indic": 41, "instal": 42, "layer": 0, "layer_oper": [16, 17, 18, 19, 20, 21], "log1p_transform": 19, "median_clean": 4, "metric": [0, 22, 23, 24], "model": [0, 25], "oper": 0, "plot": [0, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36], "plot_all_slid": 26, "plot_clust": 27, "plot_data_distribution_stat": 28, "plot_exp_frac": 29, "plot_histogram": 30, "plot_mean_std": 31, "plot_mean_std_partit": 32, "plot_random_patch": 33, "plot_test": 34, "process_dataset": 20, "pypi": 42, "spackle_clean": 5, "spare": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41], "spot": 0, "spot_featur": [37, 38, 39, 40], "tabl": 41, "tpm_normal": 21, "visualize_gene_express": 35, "visualize_moran_filt": 36, "welcom": 41}})