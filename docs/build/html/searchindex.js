Search.setIndex({"alltitles": {"API": [[0, "api"]], "Contents": [[39, "contents"]], "Dataloaders": [[0, "module-spared.dataloaders"]], "Datasets": [[0, "module-spared.datasets"]], "Denoising": [[0, "module-spared.denoising"]], "Filtering": [[0, "module-spared.filtering"]], "Gene Features": [[0, "module-spared.gene_features"]], "Graph Operations": [[0, "graph-operations"]], "Indices and tables": [[39, "indices-and-tables"]], "Installation": [[40, "installation"]], "Layer Operations": [[0, "layer-operations"]], "Metrics": [[0, "module-spared.metrics"]], "Models": [[0, "module-spared.models"]], "Plotting": [[0, "module-spared.plotting"]], "PyPI": [[40, "pypi"]], "Spot Features": [[0, "module-spared.spot_features"]], "Welcome to SpaRED\u2019s documentation!": [[39, "welcome-to-spared-s-documentation"]], "spared.dataloaders.get_graph_dataloaders": [[1, "spared-dataloaders-get-graph-dataloaders"]], "spared.dataloaders.get_pretrain_dataloaders": [[2, "spared-dataloaders-get-pretrain-dataloaders"]], "spared.datasets.get_dataset": [[3, "spared-datasets-get-dataset"]], "spared.filtering.filter_by_moran": [[4, "spared-filtering-filter-by-moran"]], "spared.filtering.filter_dataset": [[5, "spared-filtering-filter-dataset"]], "spared.filtering.get_slide_from_collection": [[6, "spared-filtering-get-slide-from-collection"]], "spared.filtering.get_slides_adata": [[7, "spared-filtering-get-slides-adata"]], "spared.gene_features.compute_moran": [[8, "spared-gene-features-compute-moran"]], "spared.gene_features.get_exp_frac": [[9, "spared-gene-features-get-exp-frac"]], "spared.gene_features.get_glob_exp_frac": [[10, "spared-gene-features-get-glob-exp-frac"]], "spared.graph_operations.get_graphs": [[11, "spared-graph-operations-get-graphs"]], "spared.graph_operations.get_graphs_one_slide": [[12, "spared-graph-operations-get-graphs-one-slide"]], "spared.graph_operations.get_sin_cos_positional_embeddings": [[13, "spared-graph-operations-get-sin-cos-positional-embeddings"]], "spared.layer_operations.add_noisy_layer": [[14, "spared-layer-operations-add-noisy-layer"]], "spared.layer_operations.combat_transformation": [[15, "spared-layer-operations-combat-transformation"]], "spared.layer_operations.get_deltas": [[16, "spared-layer-operations-get-deltas"]], "spared.layer_operations.log1p_transformation": [[17, "spared-layer-operations-log1p-transformation"]], "spared.layer_operations.process_dataset": [[18, "spared-layer-operations-process-dataset"]], "spared.layer_operations.tpm_normalization": [[19, "spared-layer-operations-tpm-normalization"]], "spared.metrics.get_metrics": [[20, "spared-metrics-get-metrics"]], "spared.metrics.get_pearsonr": [[21, "spared-metrics-get-pearsonr"]], "spared.metrics.get_r2_score": [[22, "spared-metrics-get-r2-score"]], "spared.models.ImageEncoder": [[23, "spared-models-imageencoder"]], "spared.plotting.plot_all_slides": [[24, "spared-plotting-plot-all-slides"]], "spared.plotting.plot_clusters": [[25, "spared-plotting-plot-clusters"]], "spared.plotting.plot_data_distribution_stats": [[26, "spared-plotting-plot-data-distribution-stats"]], "spared.plotting.plot_exp_frac": [[27, "spared-plotting-plot-exp-frac"]], "spared.plotting.plot_histograms": [[28, "spared-plotting-plot-histograms"]], "spared.plotting.plot_mean_std": [[29, "spared-plotting-plot-mean-std"]], "spared.plotting.plot_mean_std_partitions": [[30, "spared-plotting-plot-mean-std-partitions"]], "spared.plotting.plot_random_patches": [[31, "spared-plotting-plot-random-patches"]], "spared.plotting.plot_tests": [[32, "spared-plotting-plot-tests"]], "spared.plotting.visualize_gene_expression": [[33, "spared-plotting-visualize-gene-expression"]], "spared.plotting.visualize_moran_filtering": [[34, "spared-plotting-visualize-moran-filtering"]], "spared.spot_features.compute_dim_red": [[35, "spared-spot-features-compute-dim-red"]], "spared.spot_features.compute_patches_embeddings": [[36, "spared-spot-features-compute-patches-embeddings"]], "spared.spot_features.compute_patches_predictions": [[37, "spared-spot-features-compute-patches-predictions"]], "spared.spot_features.get_spatial_neighbors": [[38, "spared-spot-features-get-spatial-neighbors"]]}, "docnames": ["api", "api/spared.dataloaders.get_graph_dataloaders", "api/spared.dataloaders.get_pretrain_dataloaders", "api/spared.datasets.get_dataset", "api/spared.filtering.filter_by_moran", "api/spared.filtering.filter_dataset", "api/spared.filtering.get_slide_from_collection", "api/spared.filtering.get_slides_adata", "api/spared.gene_features.compute_moran", "api/spared.gene_features.get_exp_frac", "api/spared.gene_features.get_glob_exp_frac", "api/spared.graph_operations.get_graphs", "api/spared.graph_operations.get_graphs_one_slide", "api/spared.graph_operations.get_sin_cos_positional_embeddings", "api/spared.layer_operations.add_noisy_layer", "api/spared.layer_operations.combat_transformation", "api/spared.layer_operations.get_deltas", "api/spared.layer_operations.log1p_transformation", "api/spared.layer_operations.process_dataset", "api/spared.layer_operations.tpm_normalization", "api/spared.metrics.get_metrics", "api/spared.metrics.get_pearsonr", "api/spared.metrics.get_r2_score", "api/spared.models.ImageEncoder", "api/spared.plotting.plot_all_slides", "api/spared.plotting.plot_clusters", "api/spared.plotting.plot_data_distribution_stats", "api/spared.plotting.plot_exp_frac", "api/spared.plotting.plot_histograms", "api/spared.plotting.plot_mean_std", "api/spared.plotting.plot_mean_std_partitions", "api/spared.plotting.plot_random_patches", "api/spared.plotting.plot_tests", "api/spared.plotting.visualize_gene_expression", "api/spared.plotting.visualize_moran_filtering", "api/spared.spot_features.compute_dim_red", "api/spared.spot_features.compute_patches_embeddings", "api/spared.spot_features.compute_patches_predictions", "api/spared.spot_features.get_spatial_neighbors", "index", "installation"], "envversion": {"sphinx": 61, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["api.rst", "api/spared.dataloaders.get_graph_dataloaders.rst", "api/spared.dataloaders.get_pretrain_dataloaders.rst", "api/spared.datasets.get_dataset.rst", "api/spared.filtering.filter_by_moran.rst", "api/spared.filtering.filter_dataset.rst", "api/spared.filtering.get_slide_from_collection.rst", "api/spared.filtering.get_slides_adata.rst", "api/spared.gene_features.compute_moran.rst", "api/spared.gene_features.get_exp_frac.rst", "api/spared.gene_features.get_glob_exp_frac.rst", "api/spared.graph_operations.get_graphs.rst", "api/spared.graph_operations.get_graphs_one_slide.rst", "api/spared.graph_operations.get_sin_cos_positional_embeddings.rst", "api/spared.layer_operations.add_noisy_layer.rst", "api/spared.layer_operations.combat_transformation.rst", "api/spared.layer_operations.get_deltas.rst", "api/spared.layer_operations.log1p_transformation.rst", "api/spared.layer_operations.process_dataset.rst", "api/spared.layer_operations.tpm_normalization.rst", "api/spared.metrics.get_metrics.rst", "api/spared.metrics.get_pearsonr.rst", "api/spared.metrics.get_r2_score.rst", "api/spared.models.ImageEncoder.rst", "api/spared.plotting.plot_all_slides.rst", "api/spared.plotting.plot_clusters.rst", "api/spared.plotting.plot_data_distribution_stats.rst", "api/spared.plotting.plot_exp_frac.rst", "api/spared.plotting.plot_histograms.rst", "api/spared.plotting.plot_mean_std.rst", "api/spared.plotting.plot_mean_std_partitions.rst", "api/spared.plotting.plot_random_patches.rst", "api/spared.plotting.plot_tests.rst", "api/spared.plotting.visualize_gene_expression.rst", "api/spared.plotting.visualize_moran_filtering.rst", "api/spared.spot_features.compute_dim_red.rst", "api/spared.spot_features.compute_patches_embeddings.rst", "api/spared.spot_features.compute_patches_predictions.rst", "api/spared.spot_features.get_spatial_neighbors.rst", "index.rst", "installation.rst"], "indexentries": {"module": [[0, "module-spared.dataloaders", false], [0, "module-spared.datasets", false], [0, "module-spared.denoising", false], [0, "module-spared.filtering", false], [0, "module-spared.gene_features", false], [0, "module-spared.graph_operations", false], [0, "module-spared.layer_operations", false], [0, "module-spared.metrics", false], [0, "module-spared.models", false], [0, "module-spared.plotting", false], [0, "module-spared.spot_features", false]], "plot_all_slides() (in module spared.plotting)": [[24, "spared.plotting.plot_all_slides", false]], "plot_clusters() (in module spared.plotting)": [[25, "spared.plotting.plot_clusters", false]], "plot_data_distribution_stats() (in module spared.plotting)": [[26, "spared.plotting.plot_data_distribution_stats", false]], "plot_exp_frac() (in module spared.plotting)": [[27, "spared.plotting.plot_exp_frac", false]], "plot_histograms() (in module spared.plotting)": [[28, "spared.plotting.plot_histograms", false]], "plot_mean_std() (in module spared.plotting)": [[29, "spared.plotting.plot_mean_std", false]], "plot_mean_std_partitions() (in module spared.plotting)": [[30, "spared.plotting.plot_mean_std_partitions", false]], "plot_random_patches() (in module spared.plotting)": [[31, "spared.plotting.plot_random_patches", false]], "plot_tests() (in module spared.plotting)": [[32, "spared.plotting.plot_tests", false]], "spared.dataloaders": [[0, "module-spared.dataloaders", false]], "spared.datasets": [[0, "module-spared.datasets", false]], "spared.denoising": [[0, "module-spared.denoising", false]], "spared.filtering": [[0, "module-spared.filtering", false]], "spared.gene_features": [[0, "module-spared.gene_features", false]], "spared.graph_operations": [[0, "module-spared.graph_operations", false]], "spared.layer_operations": [[0, "module-spared.layer_operations", false]], "spared.metrics": [[0, "module-spared.metrics", false]], "spared.models": [[0, "module-spared.models", false]], "spared.plotting": [[0, "module-spared.plotting", false]], "spared.spot_features": [[0, "module-spared.spot_features", false]], "visualize_gene_expression() (in module spared.plotting)": [[33, "spared.plotting.visualize_gene_expression", false]], "visualize_moran_filtering() (in module spared.plotting)": [[34, "spared.plotting.visualize_moran_filtering", false]]}, "objects": {"spared": [[0, 0, 0, "-", "dataloaders"], [0, 0, 0, "-", "datasets"], [0, 0, 0, "-", "denoising"], [0, 0, 0, "-", "filtering"], [0, 0, 0, "-", "gene_features"], [0, 0, 0, "-", "graph_operations"], [0, 0, 0, "-", "layer_operations"], [0, 0, 0, "-", "metrics"], [0, 0, 0, "-", "models"], [0, 0, 0, "-", "plotting"], [0, 0, 0, "-", "spot_features"]], "spared.dataloaders": [[1, 1, 1, "", "get_graph_dataloaders"], [2, 1, 1, "", "get_pretrain_dataloaders"]], "spared.datasets": [[3, 1, 1, "", "get_dataset"]], "spared.filtering": [[4, 1, 1, "", "filter_by_moran"], [5, 1, 1, "", "filter_dataset"], [6, 1, 1, "", "get_slide_from_collection"], [7, 1, 1, "", "get_slides_adata"]], "spared.gene_features": [[8, 1, 1, "", "compute_moran"], [9, 1, 1, "", "get_exp_frac"], [10, 1, 1, "", "get_glob_exp_frac"]], "spared.graph_operations": [[11, 1, 1, "", "get_graphs"], [12, 1, 1, "", "get_graphs_one_slide"], [13, 1, 1, "", "get_sin_cos_positional_embeddings"]], "spared.layer_operations": [[14, 1, 1, "", "add_noisy_layer"], [15, 1, 1, "", "combat_transformation"], [16, 1, 1, "", "get_deltas"], [17, 1, 1, "", "log1p_transformation"], [18, 1, 1, "", "process_dataset"], [19, 1, 1, "", "tpm_normalization"]], "spared.metrics": [[20, 1, 1, "", "get_metrics"], [21, 1, 1, "", "get_pearsonr"], [22, 1, 1, "", "get_r2_score"]], "spared.models": [[23, 2, 1, "", "ImageEncoder"]], "spared.models.ImageEncoder": [[23, 3, 1, "", "__init__"]], "spared.plotting": [[24, 1, 1, "", "plot_all_slides"], [25, 1, 1, "", "plot_clusters"], [26, 1, 1, "", "plot_data_distribution_stats"], [27, 1, 1, "", "plot_exp_frac"], [28, 1, 1, "", "plot_histograms"], [29, 1, 1, "", "plot_mean_std"], [30, 1, 1, "", "plot_mean_std_partitions"], [31, 1, 1, "", "plot_random_patches"], [32, 1, 1, "", "plot_tests"], [33, 1, 1, "", "visualize_gene_expression"], [34, 1, 1, "", "visualize_moran_filtering"]], "spared.spot_features": [[35, 1, 1, "", "compute_dim_red"], [36, 1, 1, "", "compute_patches_embeddings"], [37, 1, 1, "", "compute_patches_predictions"], [38, 1, 1, "", "get_spatial_neighbors"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "terms": {"": [4, 5, 8, 17, 18, 26, 36, 37], "0": [4, 5, 9, 10, 18, 21, 22, 36, 37], "1": [9, 10, 17, 18, 21, 22], "10xgenomic_human_brain": 3, "10xgenomic_human_breast_canc": 3, "10xgenomic_mouse_brain_coron": 3, "10xgenomic_mouse_brain_sagittal_anterior": 3, "10xgenomic_mouse_brain_sagittal_posterior": 3, "128": [1, 2, 4], "16": 31, "2": [1, 17, 20, 21, 22, 33], "224": [1, 31, 36, 37], "255": [36, 37], "3": [36, 37], "32": 4, "320": 4, "4": [33, 34], "6": 32, "A": [5, 9, 10, 11, 12, 13, 18, 32, 36, 37], "For": 11, "If": [1, 2, 3, 4, 5, 18, 20, 33, 34, 36, 37, 38], "In": [1, 14], "It": [1, 4, 9, 10, 12, 13, 14, 18, 19, 21, 22, 25, 29, 31, 36, 37], "Its": 10, "Or": [36, 37], "The": [1, 2, 3, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 25, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38], "Then": 20, "To": [9, 19, 21, 22], "Will": [11, 12], "__init__": 23, "_avg_exp": [14, 16], "_description_": 1, "_moran": [4, 8], "abalo_human_squamous_cell_carcinoma": 3, "ablat": 14, "absolut": [12, 13, 20], "accord": [3, 5, 38], "account": 38, "across": [5, 8, 9, 18], "activ": 39, "ad": [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38], "ada": [], "adapt": 18, "adata": [1, 2, 4, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 25, 30, 31, 32, 33, 34, 35, 36, 37, 38], "add": [13, 14, 16, 18], "adit": 20, "after": [5, 8, 11, 18], "aggreg": 9, "all": [1, 5, 6, 7, 8, 9, 10, 11, 16, 18, 20, 21, 22, 24, 29, 30, 32, 36, 37], "alreadi": [1, 4, 18], "also": [1, 16, 19, 20, 32, 36, 37], "an": [2, 5, 6, 9, 12, 14, 18, 19, 27, 36, 37, 38], "analog": 18, "analys": 28, "analysi": 5, "analyz": 39, "ani": [5, 9, 10, 18], "anndata": [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38], "annload": 2, "annot": 19, "appli": 19, "approxim": 15, "ar": [1, 2, 3, 5, 11, 12, 13, 15, 16, 18, 19, 20, 28, 32, 34, 36, 37, 38], "argument": 5, "around": 35, "arrai": 20, "artifici": 14, "aspect": 24, "assign": 14, "assum": 15, "atabas": 39, "attribut": [11, 12, 13, 23], "auto": 34, "autocorrel": 28, "automat": 4, "avail": [11, 12], "averag": [8, 16, 18, 20, 21, 22], "axi": [21, 22], "backbon": [1, 23, 36, 37], "bar": 26, "base": [2, 5, 6, 17], "batch": [1, 2, 15, 18, 25], "batch_kei": 15, "batch_siz": [1, 2], "befor": 8, "between": [9, 10, 12, 13, 21, 22], "bidimension": 31, "binari": [14, 18], "black": 29, "blue": 28, "bool": [1, 2, 3, 8, 11, 12, 18, 20, 34, 38], "boolean": [20, 21, 22], "both": [5, 12, 23, 39], "bound": 9, "build": [11, 39], "c_d_delta": 18, "c_d_log1p": [2, 18], "c_delta": 18, "c_log1p": 18, "c_t_log1p": 1, "calculate_qc_metr": 5, "call": 32, "can": [3, 15, 19, 25, 36, 37, 38], "case": [1, 14], "cell": 28, "cell_max_count": 5, "cell_min_count": 5, "center": [11, 12, 13], "chart": 26, "check": [1, 32], "choos": 33, "chosen": [25, 34], "cialli": 39, "class": [22, 23, 32], "cluster": [25, 35], "collect": [5, 6, 7, 8, 9, 10, 11, 24, 27, 33, 38, 39], "color": [25, 30], "column": [4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 18, 21, 22], "combat": [15, 18], "combat_kei": 18, "comma": 7, "complet": [3, 5, 18, 25, 27], "comput": [1, 4, 5, 8, 9, 10, 11, 12, 14, 15, 16, 18, 20, 21, 22, 35, 36, 37, 38], "concaten": [6, 7, 11, 20], "condit": [36, 37], "connect": [11, 12, 38], "constant": 28, "contain": [5, 11, 12, 18, 20, 25, 33, 34], "control": [3, 5, 32], "convnext": [36, 37], "correct": [15, 18, 25], "correctli": 32, "correl": [20, 21, 34], "correspond": 28, "corrupt": 14, "count": [5, 18, 19, 27, 28], "creat": [14, 18, 32], "cuda": 2, "cycl": 8, "d": 39, "d_delta": 18, "d_log1p": 18, "d_log1p_moran": 18, "d_po": [11, 12], "data": [1, 2, 8, 12, 14, 15, 16, 17, 18, 19, 24, 25, 26, 28, 29, 30, 31, 33, 34, 35], "databas": 3, "datafram": [], "dataset": [1, 2, 8, 10, 11, 18, 19, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34, 38, 39], "dataset_log": 32, "dataset_nam": 3, "dataset_path": 1, "date": 32, "default": [1, 2, 11, 31, 34, 36, 37], "defin": [3, 9, 10, 15, 18, 38], "delta": [2, 11, 12, 14, 16, 18], "denois": [14, 18], "densenet": [1, 36, 37], "depend": 5, "detail": [5, 11, 20], "detailed_error": 20, "detailed_error_gen": 20, "detailed_mae_gen": 20, "detailed_mse_gen": 20, "detalied_pcc": 21, "detalied_r2_scor": 22, "determin": 16, "develop": 39, "deviat": [16, 29, 30], "dict": [5, 11, 12, 13, 18, 20, 25, 27, 32, 33, 34, 38], "dictionari": [1, 5, 11, 12, 13, 18, 20, 25, 32, 33, 34, 38], "differ": [10, 12, 13, 30], "dim": 31, "dimens": 37, "dimension": 35, "disregard": 37, "distanc": 38, "distribut": [15, 25, 26], "do": [21, 22], "doe": 1, "doesn": 18, "don": 5, "done": 30, "draw": 30, "e": 39, "each": [5, 8, 9, 10, 11, 12, 13, 16, 18, 21, 22, 25, 34, 38], "edg": [11, 12], "edge_index": [11, 12], "effect": [28, 29], "efficientnetv2": [36, 37], "either": 33, "element": [12, 38], "els": 4, "embed": [1, 11, 12, 25, 35, 36], "embeddings_": 36, "encod": [2, 5, 11, 12, 13], "ensur": 9, "erickson_human_prostate_cancer_p1": 3, "erickson_human_prostate_cancer_p2": 3, "error": 20, "esolv": 39, "everi": [12, 20], "everyth": 35, "exclud": 28, "exp_frac": [5, 9], "expect": [36, 37], "experiment": 14, "express": [2, 5, 8, 9, 10, 15, 16, 18, 19, 25, 27, 28, 30, 33, 34, 35], "extract": 19, "f": [4, 8, 14, 16, 36, 37], "fals": [2, 11, 12, 18, 20, 21, 22, 34, 38], "fan_mouse_brain_coron": 3, "fan_mouse_olfatory_bulb": 3, "figur": 28, "file": [5, 19, 28, 29], "filter": [18, 24, 25, 26, 28, 29, 30, 31, 33, 34], "filter_dataset": 18, "final": [9, 21, 22, 32], "first": [12, 28, 38], "flat": [20, 31], "flatten": [36, 37], "float": [5, 21, 22], "folder": [1, 32], "folder_path": 32, "follow": [1, 4, 5, 12, 18, 20, 36, 37], "form": 31, "format": [12, 32, 34], "found": 38, "fount": 19, "fraction": [5, 9, 10, 27], "from": [3, 4, 6, 7, 15, 16, 17, 18, 19, 28, 29, 31, 33, 36, 37, 38], "from_lay": [4, 8, 15, 16, 17, 19, 25, 30, 33, 34, 35], "function": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38], "gene": [2, 4, 5, 8, 9, 10, 14, 15, 16, 18, 19, 20, 28, 29, 30, 32, 33, 34, 37], "gene_max_count": 5, "gene_min_count": 5, "gener": [20, 25, 26, 28, 34], "genom": 19, "geo_dataload": 1, "geometr": [11, 12, 13], "geometri": [8, 12], "get": [1, 2, 6, 7, 9, 11, 12, 13, 16, 18, 20, 31], "get_exp_frac": 5, "get_glob_exp_frac": 5, "get_graphs_one_slid": 11, "get_sin_cos_positional_embed": 11, "given": [34, 36, 37], "glob_exp_frac": [5, 10], "global": [10, 20, 27], "graph": [1, 11, 12, 13, 18, 38], "graph_dict": [12, 13], "green": 28, "grid": [18, 38], "ground": [20, 21, 22], "gt_mat": [20, 21, 22], "gtf": 19, "gtf_tool": 19, "h5ad": [28, 29], "ha": [1, 12, 28, 29], "have": [4, 8, 9, 10, 12, 14, 15, 16, 18, 35, 36, 37], "heatmap": 27, "henc": 9, "here": 5, "hex_geometri": [1, 8, 11, 12, 18, 38], "hexagon": [1, 8, 11, 12, 18, 38], "highest": [4, 18], "histogram": 28, "hop": [1, 11, 12], "host": 39, "how": 30, "howev": 16, "human": 19, "i": [1, 2, 4, 5, 8, 9, 10, 11, 12, 14, 15, 16, 18, 21, 22, 25, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39], "identifi": 15, "ignor": [20, 21, 22], "imag": [2, 24, 25, 26, 29, 30, 31, 33, 34], "imagenet": [36, 37], "implement": 19, "import": [0, 36, 37], "importantli": 38, "imput": [11, 12, 18], "inceptionv3": [36, 37], "includ": [18, 20, 38], "index": [11, 12, 32, 38, 39], "indic": [11, 12], "individu": 20, "inform": [9, 10, 13, 16, 28, 29], "initi": 23, "input": [8, 13, 15], "insert": 14, "insid": [36, 37, 38], "instead": [1, 5], "int": [1, 2, 4, 5, 11, 12, 13, 18, 21, 22, 31, 32, 36, 37, 38], "intern": [8, 18, 23, 37], "ir": [21, 22], "its": [3, 14], "itself": 38, "json": 32, "keep": [4, 5, 18], "kei": [5, 8, 11, 12, 13, 18, 20, 25, 30, 33, 35, 36, 37, 38], "last": 36, "latent_dim": 23, "layer": [1, 2, 4, 8, 11, 12, 14, 15, 16, 17, 18, 19, 25, 29, 30, 33, 34, 35, 36], "least": [5, 9, 34], "leav": 5, "leiden": [25, 35], "length": 19, "less": 4, "librari": 39, "like": 13, "linear": 36, "list": [5, 7, 18, 21, 22, 34, 38], "load": [1, 28, 29], "loader": 2, "log": 32, "log1p": [14, 17, 18], "log_2": [17, 18], "logarithm": [14, 15, 17, 18], "low": 5, "lower": 9, "mae": 20, "mask": [11, 12, 14, 18, 20, 21, 22], "matric": [20, 21, 22], "matrix": [5, 9, 10, 17, 20, 21, 22, 25, 30, 33, 35], "matter": 5, "max": [12, 13], "max_abs_d_po": 12, "max_d_po": 13, "maximum": 5, "maxvit": [36, 37], "mean": [2, 4, 5, 9, 10, 11, 12, 14, 16, 18, 20, 21, 22, 29, 30], "mean_pcc": 21, "mean_r2_scor": 22, "median": 18, "method": [23, 33], "metric": [5, 18], "min_exp_frac": 5, "min_glob_exp_frac": 5, "minimum": [5, 9], "mirzazadeh_human_colon_p1": 3, "mirzazadeh_human_colon_p2": 3, "mirzazadeh_human_pediatric_brain_tumor_p1": 3, "mirzazadeh_human_pediatric_brain_tumor_p2": 3, "mirzazadeh_human_prostate_canc": 3, "mirzazadeh_human_small_intestin": 3, "mirzazadeh_mouse_bon": 3, "mirzazadeh_mouse_brain": 3, "mirzazadeh_mouse_brain_p1": 3, "mirzazadeh_mouse_brain_p2": 3, "miss": [14, 18], "mobilenetv3": [36, 37], "model": [1, 2, 24, 25, 26, 28, 29, 30, 31, 34, 36, 37], "model_path": [1, 36, 37], "modif": 18, "modifi": [13, 36, 37], "modul": [23, 39], "moran": [4, 8, 18, 28, 34], "morani": 18, "more": [5, 36, 37], "most": 34, "mous": 19, "mse": 20, "multipl": 18, "must": [3, 4, 5, 6, 7, 8, 12, 14, 15, 16, 18, 19, 20, 21, 22, 35, 36, 37], "n_gene": 20, "n_hop": [1, 11, 12, 38], "n_keep": 4, "n_observ": [21, 22], "n_patch": [36, 37], "n_sampl": 20, "n_var": 4, "n_variabl": [21, 22], "name": [3, 6, 11, 12, 13, 14, 24, 25, 26, 29, 30, 31, 32, 33, 34], "need": [36, 37], "neg": 14, "neighbor": [8, 12, 13, 35, 38], "neighborhood": 38, "new": 39, "nn": 23, "node": [11, 12], "noisi": 14, "noisy_": 14, "noisy_d": [], "non": [9, 10, 29], "none": [1, 2, 5, 18, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37], "normal": [15, 18, 19], "note": 12, "np": 20, "num_nod": [11, 12], "number": [1, 4, 9, 10, 11, 12, 18, 37], "numpi": 20, "ob": [6, 7, 15, 16, 18], "object": [1, 2, 3, 4, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 31, 34, 35, 36, 37, 38], "observ": [5, 16, 18, 34, 38], "obsm": [12, 36, 37], "one": [9, 12, 13, 21, 22, 36, 37], "ones": 39, "onli": [2, 5, 8, 11, 12, 14, 16, 18, 28, 36, 37, 38], "option": [1, 2, 3, 5, 34, 36, 37], "organ": 19, "origin": 14, "other": 5, "otherwis": [], "out": 5, "output": [15, 37], "outsid": 5, "over": [8, 17, 18, 28, 38], "packag": 15, "page": 39, "param": [], "param_dict": [5, 18, 25, 27, 32, 33, 34], "paramet": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38], "parigi_mouse_intestin": 3, "patch": [1, 2, 12, 13, 20, 21, 28, 29, 31, 36, 37], "patch_scal": [36, 37], "patch_siz": [1, 31, 32, 36, 37], "patches_scal": [36, 37], "patches_scale_": [36, 37], "path": [1, 5, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 36, 37], "patient": 33, "pca": [25, 35], "pcc": [20, 21, 22], "pearson": [20, 21], "per": 28, "perform": [1, 5, 15, 17, 18, 19, 32, 36, 37], "pie": 26, "pip": 40, "pipelin": [1, 5, 18], "place": [36, 37], "plot": 3, "plotting_gen": 33, "plotting_slid": [25, 33, 34], "po": [11, 12], "posit": [11, 12, 13, 20, 21, 22], "positional_embed": [11, 13], "pp": [5, 17, 35], "ppc": 20, "pre": 2, "pred_mat": [20, 21, 22], "predefin": 3, "predict": [1, 2, 4, 11, 12, 14, 20, 21, 22, 37], "prediction_lay": 14, "predictions_": 37, "present": [4, 5, 7, 11, 12, 18, 29, 30], "pretrain": [2, 36, 37], "previous": 14, "proce": 4, "process": [1, 2, 5, 18, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38], "processed_adata": [24, 25, 26, 28, 29, 30, 31, 32, 33, 34], "project": 39, "proport": [9, 10], "provid": 34, "public": 19, "pure": 2, "purpos": 14, "py": 19, "pycombat": 15, "python": 39, "pytorch": [11, 12, 13, 36, 37], "qualiti": [3, 5, 32], "r": 39, "r2": [20, 22], "radiu": 12, "rais": [36, 37], "random": [31, 34], "randomli": [25, 33], "rang": 5, "ratio": 24, "raw": [5, 18, 19, 27, 28], "raw_adata": [27, 28, 29, 32], "re": 14, "read": 5, "readi": [24, 25, 26, 28, 29, 30, 31, 34], "real": [11, 12], "receiv": [3, 6, 7, 12, 20, 21, 22], "recomput": 1, "red": 28, "reduct": 35, "refer": 19, "regress": 20, "rel": [11, 12], "remov": [5, 19], "replac": 14, "represent": 36, "reproduc": 32, "reshap": 31, "resnet": [36, 37], "resnet50": [36, 37], "resnetxt": [36, 37], "respect": [11, 12], "result": [15, 16, 17, 18, 19, 32], "retriev": [3, 6], "return": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 35, 38], "row": [11, 12, 13, 21, 22, 28], "run": 40, "same": 32, "sampl": 5, "save": [1, 8, 16, 17, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34], "sc": [5, 17, 35], "scale": 14, "scanpi": [5, 17], "scatter": [29, 30], "score": [20, 22], "scriptmodul": 23, "search": 39, "second": 28, "see": [5, 11, 29, 30], "select": [4, 33], "separ": 7, "set": [1, 2, 3, 18, 31, 36, 37, 39], "shape": [20, 21, 22, 36, 37], "share": 23, "should": [14, 18, 19], "show": [31, 34], "shuffl": [1, 2], "shufflenetv2": [36, 37], "similar": 5, "simpl": [17, 35], "singl": [11, 12, 36, 37, 38], "size": [1, 2, 31, 36, 37, 38], "slide": [5, 6, 7, 8, 9, 10, 11, 12, 18, 24, 25, 26, 27, 33, 34, 38], "slide_id": [6, 7], "slide_list": 7, "so": 15, "sourc": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38], "spa": 39, "space": 7, "spare": [0, 40], "spatial": [8, 25, 34, 39], "spatialdataset": 3, "specif": [33, 34], "specifi": [1, 3, 4, 5, 6, 7, 14, 18, 19, 25, 28, 29, 30, 31, 33, 34, 36, 37], "specifii": [], "split": [16, 25, 26, 30, 33, 34], "split_nam": [25, 32, 33, 34], "spot": [5, 9, 10, 11, 18, 26, 38], "squar": [20, 24], "standard": [29, 30], "start": [36, 37], "stat": 26, "state": 23, "statist": [4, 8, 28, 34], "std": [29, 30], "step": [1, 5, 32], "stnet_dataset": 33, "store": [1, 14, 15, 16, 17, 19, 25, 30, 35, 36, 37], "str": [1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], "string": [7, 34, 36, 37], "subplot": 34, "substr": [11, 12], "suitabl": 5, "summari": 5, "support": [36, 37], "swin": [36, 37], "t": [5, 18], "take": [5, 9, 15, 16, 17, 19, 21, 22, 24, 38], "taken": [7, 19], "task": 30, "tensor": [20, 21, 22], "test": [1, 2, 30], "th": [21, 22], "than": [4, 36, 37], "thei": [1, 36, 37], "them": [1, 5, 11, 16, 20, 21, 22, 31, 33, 39], "thi": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38, 39], "time": 32, "titl": 34, "tl": 35, "to_lay": [15, 16, 17, 19], "tool": 39, "top": [18, 34], "top_moran_gen": 18, "topolog": 38, "torch": [20, 21, 22], "total": [5, 28], "total_count": 5, "tpm": [18, 19], "tpmx": [], "tractabl": 30, "train": [1, 2, 16, 30], "transcriptom": 39, "transform": [13, 15, 16, 17, 18, 35, 36, 37], "true": [1, 2, 3, 8, 11, 12, 18, 20, 34, 38], "truth": [20, 21, 22], "tupl": [1, 2, 12, 21, 22], "two": 12, "txt": [5, 32], "type": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 35, 38], "umap": [25, 35], "under": [13, 39], "unexpress": 5, "unfilt": [5, 27], "union": 20, "unprocess": [5, 27], "updat": [4, 8, 9, 10, 14, 15, 16, 17, 19], "us": [1, 2, 5, 8, 11, 12, 14, 15, 16, 19, 24, 25, 26, 28, 29, 30, 31, 32, 34, 35, 36, 37], "use_cuda": 2, "use_pretrain": 23, "used_mean": [11, 12], "user": 15, "val": 30, "valid": [1, 2, 5, 18, 20], "valu": [4, 5, 8, 9, 10, 11, 12, 13, 14, 16, 18, 19, 34, 35, 36, 37, 38], "valueerror": [36, 37], "var": [4, 8, 9, 10, 14, 16, 18], "variabl": 15, "variou": 18, "vicari_human_striatium": 3, "vicari_mouse_brain": 3, "vicin": 38, "villacampa_kidney_organoid": 3, "villacampa_lung_organoid": 3, "villacampa_mouse_brain": 3, "vision": 2, "visium": [8, 11, 18, 33, 38], "visual": [3, 25, 34], "vit": [36, 37], "wa": 4, "wai": 4, "we": [5, 37], "wee": 4, "wether": [21, 22], "when": 38, "where": [1, 9, 10, 11, 12, 13, 25, 30, 35, 38], "whether": [1, 2, 8, 11, 12, 18], "which": [4, 11, 12, 14, 15, 19, 28], "whole": [5, 10, 24], "wideresnet": [36, 37], "wildcard_gen": 5, "wise": 20, "without": 7, "wrap": 11, "wrapper": [17, 35], "x": [2, 5, 9, 10, 17], "xpression": 39, "y": [11, 12], "zero": [5, 14, 29]}, "titles": ["API", "spared.dataloaders.get_graph_dataloaders", "spared.dataloaders.get_pretrain_dataloaders", "spared.datasets.get_dataset", "spared.filtering.filter_by_moran", "spared.filtering.filter_dataset", "spared.filtering.get_slide_from_collection", "spared.filtering.get_slides_adata", "spared.gene_features.compute_moran", "spared.gene_features.get_exp_frac", "spared.gene_features.get_glob_exp_frac", "spared.graph_operations.get_graphs", "spared.graph_operations.get_graphs_one_slide", "spared.graph_operations.get_sin_cos_positional_embeddings", "spared.layer_operations.add_noisy_layer", "spared.layer_operations.combat_transformation", "spared.layer_operations.get_deltas", "spared.layer_operations.log1p_transformation", "spared.layer_operations.process_dataset", "spared.layer_operations.tpm_normalization", "spared.metrics.get_metrics", "spared.metrics.get_pearsonr", "spared.metrics.get_r2_score", "spared.models.ImageEncoder", "spared.plotting.plot_all_slides", "spared.plotting.plot_clusters", "spared.plotting.plot_data_distribution_stats", "spared.plotting.plot_exp_frac", "spared.plotting.plot_histograms", "spared.plotting.plot_mean_std", "spared.plotting.plot_mean_std_partitions", "spared.plotting.plot_random_patches", "spared.plotting.plot_tests", "spared.plotting.visualize_gene_expression", "spared.plotting.visualize_moran_filtering", "spared.spot_features.compute_dim_red", "spared.spot_features.compute_patches_embeddings", "spared.spot_features.compute_patches_predictions", "spared.spot_features.get_spatial_neighbors", "Welcome to SpaRED\u2019s documentation!", "Installation"], "titleterms": {"": 39, "add_noisy_lay": 14, "api": 0, "clean_nois": [], "combat_transform": 15, "compute_dim_r": 35, "compute_moran": 8, "compute_patches_embed": 36, "compute_patches_embeddings_and_predict": [], "compute_patches_predict": 37, "content": 39, "dataload": [0, 1, 2], "dataset": [0, 3], "denois": 0, "document": 39, "featur": 0, "filter": [0, 4, 5, 6, 7], "filter_by_moran": 4, "filter_dataset": 5, "gene": 0, "gene_featur": [8, 9, 10], "get_dataset": 3, "get_delta": 16, "get_exp_frac": 9, "get_glob_exp_frac": 10, "get_graph": 11, "get_graph_dataload": 1, "get_graphs_one_slid": 12, "get_metr": 20, "get_pearsonr": 21, "get_plotting_slides_adata": [], "get_pretrain_dataload": 2, "get_r2_scor": 22, "get_sin_cos_positional_embed": 13, "get_slide_from_collect": 6, "get_slides_adata": 7, "get_spatial_neighbor": 38, "graph": 0, "graph_oper": [11, 12, 13], "imageencod": 23, "indic": 39, "instal": 40, "layer": 0, "layer_oper": [14, 15, 16, 17, 18, 19], "log1p_transform": 17, "metric": [0, 20, 21, 22], "model": [0, 23], "oper": 0, "plot": [0, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34], "plot_all_slid": 24, "plot_clust": 25, "plot_data_distribution_stat": 26, "plot_exp_frac": 27, "plot_histogram": 28, "plot_mean_std": 29, "plot_mean_std_partit": 30, "plot_random_patch": 31, "plot_test": 32, "process": [], "process_dataset": 18, "pypi": 40, "refine_plotting_slides_str": [], "spare": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39], "spot": 0, "spot_featur": [35, 36, 37, 38], "tabl": 39, "tpm_normal": 19, "visual": [], "visualize_gene_express": 33, "visualize_moran_filt": 34, "welcom": 39}})